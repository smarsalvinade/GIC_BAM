# GIC_BAM
Software to compute Geomagnetically Induced Currents (GIC) in power networks. Based on the Bus Admittance Matrix method (BAM). This method is faster in essence than LP and NAM traditional methods, as it uses smaller matrices.

Input:

 - Real network parameters (line and grounding resistances, transformer types and winding resistances, substation locations, ...) conveniently arranged in input Excel file. Assumed constant in time.

 - Geoelectric field over time. It may be either homogeneous (constant in space) or heterogeneous (variable in space). If heterogeneous, the E field is given in a grid covering the power network area. The E field in the entire power network is interpolated from this grid.

      Note: Heterogeneous E-fields are assumed to have been generated by other means (e.g., from magnetic field and earth conductivity data).

Output:
 - Ig: GIC flow to earth in substation earthing over time,
 - Ilinph: GIC flow per phase in each transmission line over time.
 - Iwi: GIC flow in transformer windings (/phase) over time.
 - It: effective GIC flow in transformers (/phase) over time.
 
# File description
The Python and Matlab folders contain independent and nearly equivalent code in these languages to compute the GIC (see below for a description of the content).

XLS files contain example power networks to be used as an input both in the Python and Matlab code:
- Benchmark.xlsx: Described in *Horton, R., Boteler, D., Overbye, T. J., Pirjola, R., & Dugan, R. C. (2012). A test case for the calculation of geomagnetically induced currents. IEEE Transactions on Power Delivery, 27, 2368– 2373. https://doi.org/10.1109/TPWRD.2012.2206407
- Horton&BotelerGrid.xlsx: Described in *Horton, R., & Boteler, D. H. (2013). Calculation of GIC in bulk power systems. In Proceedings CIGRE-US grid of the future symposium, Boston, US, October 20–22.
- TstGrid_a.xlsx and TstGrid_b.xlsx: Described in *S. Marsal, J. M. Torta, V. Canillas‐Pérez, J. J. Curto, A New Standalone Tool for DC‐Equivalent Network Generation and GIC Calculation in Power Grids With Multiple Voltage Levels, Space Weather, 10.1029/2021SW002984, 20, 3, (2022).

TXT files:
- LatLon_Egrid_SE_USA.txt: Latitude and longitude of the grid points where the geoelectric field (E) is specified.
- E_2D_East.txt: East component of the E-field at each grid point (LatLon_Egrid_SE_USA.txt) through time.
- E_2D_North.txt: North component of the E-field at each grid point (LatLon_Egrid_SE_USA.txt) through time.
- LatLon_SE_USA.txt: Latitude and longitude of the coastline of South-East USA (to plot the results).

Python folder:
- GIC_BAM.yml: Python environment to be created (see GIC_BAM_Guide_inputE.docx for instructions).
- GIC_BAM_t_input_E.py: Python code to compute the GIC from the E-field.

Matlab folder:
- ConsEqNet.m: Constructs the DC-equivalent network. Called by GIC_BAM_t_inputE.m
- deg2utm_zone.m: Lat, lon to UTM coordinates with a specified constant zone. Called by GIC_BAM_t_inputE.m
- GIC_BAM_t_inputE.m: Matlab code to compute the GIC from the E-field.
